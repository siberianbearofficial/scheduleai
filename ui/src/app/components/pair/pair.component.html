<button
  tuiCardLarge
  tuiHeader
  tuiSurface="floating"
  type="button"
  [tuiHint]="tooltip"
>
  @if (pair) {
    <h1 class="card" tuiTitle>
      <div class="convenience">
        {{ formatDate(pair.startTime) }}
        <tui-badge
          [appearance]="getAppearance(pair)"
          tuiStatus
        >
          @if (pair.status == MergedPairStatus.collision) {
            <span>С пропуском пар</span>
          } @else if (pair.status == MergedPairStatus.inGap || pair.waitTimeSec < 1800) {
            Удобно
          } @else {
            Ждать {{ Math.floor(pair.waitTimeSec / 3600) }}ч {{ pair.waitTimeSec / 60 % 60 }}м
          }
        </tui-badge>
      </div>
      <span tuiSubtitle> {{ pair.discipline }}, {{ pair.actType }} </span>
    </h1>
  }
</button>

<ng-template #tooltip>
  @if (pair) {
    @if (pair.status == MergedPairStatus.collision) {
      <p>Придется пропустить:</p>
      <ul>
        @for (collision of pair.collisions; track collision.startTime) {
          <li>{{ collision.discipline }} ({{ collision.actType }})</li>
        }
      </ul>
    } @else if (pair.status == MergedPairStatus.inGap) {
      <p>Во время "окна"</p>
    } @else if (pair.status == MergedPairStatus.beforePairs) {
      <p>Перед парами: после окончания ждать
        <b>{{ Math.floor(pair.waitTimeSec / 3600) }}ч {{ pair.waitTimeSec / 60 % 60 }}м</b>
      </p>
    } @else {
      <p>После пар: ждать
        <b>{{ Math.floor(pair.waitTimeSec / 3600) }}ч {{ pair.waitTimeSec / 60 % 60 }}м</b>
      </p>
    }
  }
</ng-template>
